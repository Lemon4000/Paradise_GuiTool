## 技术选型
- 框架：PySide6（Qt 6，优雅主题与原生控件，信号/槽保证响应流畅）。
- 串口：沿用现有 `pyserial`（跨平台且与当前协议实现兼容）。
- 配置：兼容 `config/A组.csv` 与 `config/params.xlsx`（自动优先 Excel）。
- 打包：`pyinstaller` 生成单文件 exe（Windows）。

## 核心功能
- 端口管理：自动枚举串口、连接/断开、状态指示、日志窗。
- 参数视图：表格显示 `A0..A19`，列含 `Name/Unit/Value/Min/Max/Precision/Description`；支持筛选与快速编辑。
- 读取/写入：一键读取当前组、批量写入；越界/精度校验；写入后自动回读校验。
- 组切换：下拉选择组（A/B/C…），动态加载映射与默认值。
- 映射维护：导入 Excel/CSV、即时生效；支持刷新。
- 主题与美观：现代浅/深色主题、扁平化按钮、状态栏即时反馈、图标资源。

## 架构设计
- UI 线程：仅负责绘制与用户交互。
- 后台线程：串口 IO（读取、写入、监听）均在 `QThread` 中执行，使用信号/槽回传结果，避免阻塞。
- 模块划分：
  - `usart`：复用现有 `build_frame/parse_frame/read_group/write_group`，新增异步封装。
  - `mapping`：读取 Excel/CSV，提供验证规则与显示名称。
  - `ui`：主窗口、参数表模型、端口面板、日志面板。
  - `themes/resources`：图标、样式表。

## 界面布局
- 顶部工具栏：`端口选择`、`连接/断开`、`组选择`、`读取`、`写入`、`导入映射`。
- 中间：参数表（可编辑 `Value`），右侧信息卡片显示 `Name/Unit/范围/说明`。
- 底部状态栏：`连接状态`、`最近操作结果`、`耗时(ms)`。
- 左侧日志窗：显示通信帧（可切换 ASCII/HEX）。

## 交互细节
- 读取：点击后发送 `#READ:group;`，解析成功更新表格；失败弹出无阻塞提示并写日志。
- 写入：编辑后点击写入，先本地校验；发送、等待 ACK/回读；一致则绿色提示，否则红色并显示差异。
- 端口变化：动态刷新串口列表；断开自动停止线程；异常自动重连可选。

## 验证与测试
- 单元测试：帧构建/解析（CRC16/SUM8/NONE）、越界/精度校验、CSV/Excel 映射加载。
- 集成测试：虚拟串口环回，UI 操作下读写稳定性与异常处理。
- 性能：后台线程 + 去抖逻辑；超时可配置；大表渲染使用 `QAbstractTableModel` 保证流畅。

## 质量与健壮性
- 全面异常捕获，用户提示友好且不阻塞；日志写入文件。
- 输入校验：仅允许数值与约束范围；精度自动格式化。
- 无副作用：所有串口资源在连接生命周期内严格管理，退出时安全释放。

## 目录结构
- `gui/main.py`（启动入口）
- `gui/views/MainWindow.py`（主窗体）
- `gui/models/ParamTableModel.py`（参数表模型）
- `gui/services/SerialWorker.py`（串口线程）
- `gui/resources/`（图标/样式）
- 复用：`Usart_Para_FK.py`（协议与映射）

## 依赖
- `PySide6`、`pyserial`、`openpyxl`（如仅用 CSV 可不装 `openpyxl`）。

## 交付与使用
- 代码与 GUI 目录按上结构创建，默认读取 `config/`。
- 提供 `run` 与 `build` 脚本；生成 `exe` 可直接分发。
- 文档：快速上手、常见问题、参数命名规范。

## 后续扩展
- 多组多页签、批量导入/导出参数、历史版本管理、校准向导、设备自检。

确认后我将：
1) 创建 GUI 目录与文件并实现主窗口、参数表与串口线程；
2) 接入现有协议模块、打通读写流程；
3) 添加主题与资源，完成打包与测试。